<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Project Gantt — Dev + Billing</title>

<style>
:root {
  --bg:#f6f7fb;
  --card:#fff;
  --muted:#586074;
  --accent:#234b8a;
  --accent-alt:#c43b52;
  --lane-w:360px;
  --row-h:50px;
}
*{ box-sizing:border-box; }
body{
  font-family:Inter, ui-sans-serif, system-ui;
  margin:0; background:var(--bg); color:#0b1530;
  height:100vh; overflow:hidden;
}
.wrap{ width:100vw; height:100vh; display:flex; flex-direction:column; }
header{ padding:16px 20px; background:white; display:flex; justify-content:space-between; align-items:center; box-shadow:0 4px 10px rgba(0,0,0,0.05);}
h1{ margin:0; font-size:24px; } p.lead{ margin:4px 0 0; color:var(--muted); font-size:14px; }
.card{ flex:1; background:white; display:flex; overflow:hidden; }
.gantt{ display:flex; width:100%; height:100%; overflow:hidden; }
.lanes{ min-width:var(--lane-w); height:100%; overflow-y:auto; border-right:1px solid rgba(0,0,0,0.1); background:white; }
.timeline-wrap{ flex:1; overflow:auto; height:100%; position:relative; }
.timeline-grid{ position:relative; min-width:100%; }
.grid-header{ display:flex; position:sticky; top:0; background:white; z-index:10; border-bottom:1px solid #ddd; }
.grid-col{ min-width:80px; padding:10px 6px; text-align:center; font-size:13px; border-left:1px solid rgba(0,0,0,0.08); color:var(--muted); font-weight:600; }
.grid-row{ display:flex; }
.cell{ min-width:80px; height:var(--row-h); border-left:1px solid rgba(0,0,0,0.05); border-bottom:1px dashed rgba(0,0,0,0.05); }
.lane-box{ height:var(--row-h); padding:6px 10px; border-bottom:1px solid rgba(0,0,0,0.05);}
.lane-title{ font-weight:600; }
.lane-index{ font-weight:700; width:24px; opacity:0.6; }
.bars{ position:absolute; left:0; top:var(--row-h);}
.bar{ position:absolute; height:32px; border-radius:8px; padding:0 12px; display:flex; align-items:center; color:white; font-size:13px; font-weight:600; box-shadow:0 4px 12px rgba(0,0,0,0.2); cursor:pointer;}
.bar.blue{ background:linear-gradient(90deg,#2b6fb3,#1f4e92);}
.bar.red{ background:linear-gradient(90deg,#c43b52,#8b2740);}
.bar.arrow::after{ content:""; position:absolute; right:-14px; border-top:16px solid transparent; border-bottom:16px solid transparent; border-left:14px solid rgba(0,0,0,0.15);}
.tooltip{ position:fixed; background:#0b1724; color:white; padding:8px 10px; border-radius:8px; font-size:13px; opacity:0; z-index:50; pointer-events:none; transition:120ms; }
.controls{ display:flex; gap:10px; align-items:center; }
.btn{ padding:8px 12px; border-radius:8px; background:white; border:1px solid #ccc; cursor:pointer; }
.legend .box{ width:14px; height:14px; border-radius:3px; }

/* Floating window */
#phaseWindow {
  position:fixed; top:50%; left:50%; transform:translate(-50%,-50%);
  width:80%; height:80%; background:white; box-shadow:0 10px 30px rgba(0,0,0,0.3);
  overflow-y:auto; padding:20px; border-radius:12px; z-index:100; display:none;
}
#closePhaseWindow {
  position:absolute; top:10px; right:10px; padding:6px 12px; cursor:pointer;
  border:none; background:#c43b52; color:white; border-radius:6px;
}
#phaseContent h2 { margin-top:0; }
#phaseContent h3 { margin-bottom:5px; }
#phaseContent ul { margin-top:0; }
</style>
</head>
<body>

<div class="wrap">
<header>
  <div>
    <h1>Development & Billing Gantt</h1>
    <p class="lead">Full-screen Gantt chart (auto-expanded).</p>
  </div>
  <div class="controls">
    <div class="legend">
      <span class="box" style="background:#2b6fb3"></span> Duration
      &nbsp;&nbsp;
      <span class="box" style="background:#c43b52"></span> Milestone
    </div>
    <button class="btn" id="zoomIn">Zoom In</button>
    <button class="btn" id="zoomOut">Zoom Out</button>
  </div>
</header>

<div class="card">
  <div class="gantt">
    <div class="lanes" id="lanes"></div>
    <div class="timeline-wrap">
      <div class="timeline-grid" id="timelineGrid">
        <div class="grid-header" id="gridHeader"></div>
        <div id="gridBody"></div>
        <div class="bars" id="bars"></div>
      </div>
    </div>
  </div>
</div>
</div>

<!-- Tooltip -->
<div class="tooltip" id="tooltip"></div>

<!-- Phase 2 Floating Window -->
<div id="phaseWindow">
  <button id="closePhaseWindow">X</button>
  <div id="phaseContent"></div>
</div>

<script>
// --- Helper Functions ---
function addDays(d,n){ let x=new Date(d); x.setDate(x.getDate()+n); return x; }
function daysBetween(a,b){ return Math.round((b-a)/(1000*60*60*24)); }
function formatDate(d){ return d.toISOString().slice(0,10); }

// --- Project Dates & Tasks ---
const projectStart = new Date(2025,10,17); // Nov 17, 2025
const tasks=[]; 
let cursor=new Date(projectStart);

// Phase 1
tasks.push({
  id:1,
  name:'Phase 1 — Initial Setup & Feature Enhancements',
  start:new Date(cursor),
  end:addDays(cursor,13),
  color:'blue',
  notes:[
    'User management module implementation',
    'PO dashboard revision and adjustments',
    'Rate card feature polishing',
    'Begin interface development for manual workflow & monitoring system'
  ]
});
cursor=addDays(cursor,14);

// Phase 2
tasks.push({
  id:2,
  name:'Phase 2 — Manual Workflow System for Billing',
  start:new Date(cursor),
  end:addDays(cursor,20),
  color:'blue',
  notes:[
    'Develop manual workflow process for billing (1–4 weeks)',
    'Admin monitors via Prebilling Dashboard',
    'Step 1 – Create & Initialize Billing Cycle',
    'Step 2 – Ticket Data Upload (Regional Stage)',
    'Step 3 – Rate Card Assignment (FSO → Admin)',
    'Step 4 – Manual Computation & Verification',
    'Step 5 – Consolidation & Upload to HCL',
    'Step 6 – Review & Monitoring (HCL Feedback)',
    'Step 7 – Query Resolution & Resubmission',
    'Step 8 – Final Approval & Invoice Preparation',
    '⚠ Phase 3 can start when Phase 2 reaches 70% completion'
  ]
});
cursor=addDays(cursor,21);

// Phase 3
tasks.push({
  id:3,
  name:'Phase 3 — Finalization & AI Layer Kickoff',
  start:new Date(cursor),
  end:addDays(cursor,20),
  color:'blue',
  notes:[
    'Finalize and test manual workflow & monitoring system',
    'Initiate development of AI automation layer for billing workflow and monitoring'
  ]
});
cursor=addDays(cursor,21);

// Phase 4
tasks.push({
  id:4,
  name:'Phase 4 — Billing Run Automation',
  start:new Date(cursor),
  end:addDays(cursor,20),
  color:'red',
  notes:[
    'Develop billing run automation system',
    'Integrate AI-driven workflow into billing operations'
  ]
});
cursor=addDays(cursor,21);

// --- Render Gantt Chart ---
const minDate = projectStart;
const maxDate = addDays(tasks[tasks.length-1].end,7);
const totalDays = daysBetween(minDate,maxDate)+1;

const lanesEl=document.getElementById('lanes');
const gridHeader=document.getElementById('gridHeader');
const gridBody=document.getElementById('gridBody');
const barsEl=document.getElementById('bars');
const tooltip=document.getElementById('tooltip');

let pxPerDay=26;

function render(){
  lanesEl.innerHTML=''; gridHeader.innerHTML=''; gridBody.innerHTML=''; barsEl.innerHTML='';

  // Header
  for(let d=0; d<totalDays; d++){
    const dt = addDays(minDate,d);
    const h = document.createElement('div');
    h.className='grid-col';
    h.style.minWidth = pxPerDay + 'px';
    h.textContent = dt.toLocaleDateString('en-US',{month:'short',day:'numeric'});
    gridHeader.appendChild(h);
  }

  // Lanes & rows
  tasks.forEach((t,i)=>{
    const lane = document.createElement('div');
    lane.className='lane-box';
    lane.innerHTML = `<div style="display:flex;gap:10px;align-items:center;">
      <div class="lane-index">${t.id}</div>
      <div>
        <div class="lane-title">${t.name}</div>
        <div style="font-size:12px;color:var(--muted)">
          ${formatDate(t.start)} → ${formatDate(t.end)}
        </div>
      </div>
    </div>`;
    lanesEl.appendChild(lane);

    const row = document.createElement('div');
    row.className='grid-row';
    for(let d=0; d<totalDays; d++){
      const cell=document.createElement('div');
      cell.className='cell';
      cell.style.minWidth = pxPerDay + 'px';
      row.appendChild(cell);
    }
    gridBody.appendChild(row);
  });

  // Bars
  tasks.forEach((t,i)=>{
    const offset = daysBetween(minDate,t.start);
    const span = daysBetween(t.start,t.end)+1;
    const bar=document.createElement('div');
    bar.className = 'bar '+t.color+' arrow';
    bar.style.left = (offset * pxPerDay) + 'px';
    bar.style.top = (i * 50 + 10) + 'px';
    bar.style.width = (span * pxPerDay) + 'px';
    bar.innerHTML = `<div class="phase-name">${t.name}</div>`;

    bar.onmouseenter = () => {
      const r = bar.getBoundingClientRect();
      tooltip.style.opacity=1;
      tooltip.style.left = (r.left + r.width/2) + 'px';
      tooltip.style.top = (r.top - 10) + 'px';
      tooltip.innerHTML = `<strong>${t.name}</strong><br>${formatDate(t.start)} → ${formatDate(t.end)}<br><br>${t.notes.map(n=>'• '+n).join('<br>')}`;
    };
    bar.onmouseleave = ()=> tooltip.style.opacity=0;

    // --- Phase 2 Click Event ---
    if(t.id===2){
      bar.onclick = ()=> openPhaseTwo();
    }

    barsEl.appendChild(bar);
  });
}

document.getElementById("zoomIn").onclick = ()=>{ pxPerDay=Math.min(70,pxPerDay+6); render(); };
document.getElementById("zoomOut").onclick = ()=>{ pxPerDay=Math.max(10,pxPerDay-6); render(); };
window.onload = ()=> render();

// --- Phase 2 Floating Window ---
const phaseWindow = document.getElementById('phaseWindow');
const phaseContent = document.getElementById('phaseContent');
document.getElementById('closePhaseWindow').onclick = () => {
  phaseWindow.style.display = 'none';
};

// Function to open Phase 2 window with daily breakdown
function openPhaseTwo() {
  const dailyPlan = [
    { day:'Nov 17', tasks:['Overview & Purpose', 'Main Admin responsibilities'] },
    { day:'Nov 18', tasks:['Admin Dashboard Core Components: A & B'] },
    { day:'Nov 19', tasks:['Admin Dashboard Core Components: C & D', 'Table Management System start'] },
    { day:'Nov 20', tasks:['Manual Workflow Steps: Step 1 – Step 3'] },
    { day:'Nov 21', tasks:['Manual Workflow Steps: Step 4 – Step 6'] },
    { day:'Nov 22', tasks:['Manual Workflow Steps: Step 7 – Step 8', 'Deliverables & Review'] }
  ];

  let html = `<h2>Phase 2 — Admin Overview & Manual Workflow</h2>`;
  html += `<p>The Excis Prebilling Dashboard is a centralized, human-operated platform for managing the full HCL Prebilling Upload and Approval process without AI automation.</p>`;
  dailyPlan.forEach(d=>{
    html += `<h3>${d.day}</h3><ul>${d.tasks.map(t=>`<li>${t}</li>`).join('')}</ul>`;
  });

  phaseContent.innerHTML = html;
  phaseWindow.style.display = 'block';
}
</script>
</body>
</html>
